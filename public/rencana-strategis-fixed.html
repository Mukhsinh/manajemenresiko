<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rencana Strategis - Fixed</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
        }
        
        .page-content {
            display: none;
            padding: 20px;
        }
        
        .page-content.active {
            display: block;
        }
        
        .page-header {
            background-color: #ffffff;
            color: #2c3e50;
            border-left: 4px solid #8B0000;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .card {
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        .table thead {
            background-color: #f8f9fa;
            color: #495057;
        }
        
        .badge-success { background-color: #28a745; }
        .badge-warning { background-color: #ffc107; color: #212529; }
        .badge-secondary { background-color: #6c757d; }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">
                <i class="fas fa-chart-line me-2"></i>
                Rencana Strategis
            </a>
        </div>
    </nav>
    
    <!-- Main Content -->
    <div class="container-fluid mt-3">
        <!-- Rencana Strategis Page -->
        <div id="rencana-strategis" class="page-content active">
            <div id="rencana-strategis-content">
                <!-- Content will be loaded here -->
                <div class="text-center py-5">
                    <i class="fas fa-spinner fa-spin fa-3x text-muted mb-3"></i>
                    <h5 class="text-muted">Loading Rencana Strategis...</h5>
                    <p class="text-muted">Please wait while the module initializes</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Mock API for testing -->
    <script>
        window.apiCall = async function(endpoint, options = {}) {
            console.log(`API Call: ${endpoint}`, options);
            
            // Simulate network delay
            await new Promise(resolve => setTimeout(resolve, Math.random() * 500 + 100));
            
            if (endpoint.includes('/api/rencana-strategis')) {
                if (endpoint.includes('/generate/kode')) {
                    return { kode: `RS-2025-${String(Math.floor(Math.random() * 1000)).padStart(3, '0')}` };
                }
                
                return [
                    {
                        id: '1',
                        kode: 'RS-2025-001',
                        nama_rencana: 'Peningkatan Kualitas Pelayanan',
                        deskripsi: 'Meningkatkan kualitas pelayanan kepada masyarakat',
                        periode_mulai: '2025-01-01',
                        periode_selesai: '2025-12-31',
                        target: 'Mencapai tingkat kepuasan 90%',
                        indikator_kinerja: 'Indeks Kepuasan Masyarakat',
                        status: 'Aktif'
                    },
                    {
                        id: '2',
                        kode: 'RS-2025-002',
                        nama_rencana: 'Digitalisasi Layanan Publik',
                        deskripsi: 'Mengimplementasikan sistem digital untuk layanan publik',
                        periode_mulai: '2025-02-01',
                        periode_selesai: '2025-11-30',
                        target: 'Semua layanan tersedia online',
                        indikator_kinerja: 'Persentase layanan digital',
                        status: 'Draft'
                    }
                ];
            }
            
            if (endpoint.includes('/api/visi-misi')) {
                return [
                    {
                        id: '1',
                        visi: 'Menjadi organisasi terdepan dalam pelayanan publik',
                        misi: '1. Memberikan pelayanan terbaik\n2. Meningkatkan transparansi\n3. Mengembangkan SDM'
                    }
                ];
            }
            
            return [];
        };
        
        window.waitForAuthReady = async function(timeout = 5000) {
            console.log('Mock auth ready');
            return Promise.resolve();
        };
    </script>
    
    <!-- Fixed System Scripts -->
    <script src="/js/startup-script.js"></script>
    <script src="/js/page-initialization-system-fixed.js"></script>
    <script src="/js/rencana-strategis-fixed.js"></script>
    
    <script>
        // Initialize when page loads
        window.addEventListener('pageInitSystemReady', (event) => {
            console.log('âœ… Page initialization system ready');
            
            setTimeout(() => {
                if (window.RencanaStrategisModuleFixed) {
                    window.RencanaStrategisModuleFixed.load();
                }
            }, 500);
        });
        
        console.log('ðŸš€ Rencana Strategis page loaded with fixed system');
    </script>
</body>
</html>