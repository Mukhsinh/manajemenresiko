<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Residual Risk Icons Fix</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .test-container {
            padding: 2rem;
            background: #f8f9fa;
            min-height: 100vh;
        }
        .test-section {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        .badge-demo {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin: 1rem 0;
        }
        .chart-container {
            height: 500px;
            position: relative;
        }
        .legend-demo {
            display: flex;
            gap: 2rem;
            justify-content: center;
            margin: 1rem 0;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .legend-symbol {
            width: 20px;
            height: 20px;
            border: 2px solid #000;
        }
        .legend-circle {
            border-radius: 50%;
            background: #00FFFF;
        }
        .legend-diamond {
            transform: rotate(45deg);
            background: #000000;
        }
        .legend-triangle {
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 17px solid #FFFFFF;
            border: 2px solid #000;
            background: transparent;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1><i class="fas fa-chart-pie text-primary"></i> Test Residual Risk Icons & Colors Fix</h1>
        <p class="text-muted">Testing the updated residual risk matrix with new icons and color scheme</p>

        <!-- Badge Colors Test -->
        <div class="test-section">
            <h3>Risk Level Badge Colors Test</h3>
            <div class="badge-demo">
                <span class="badge-status badge-low-risk">LOW RISK</span>
                <span class="badge-status badge-medium-risk">MEDIUM RISK</span>
                <span class="badge-status badge-high-risk">HIGH RISK</span>
                <span class="badge-status badge-extreme-high">EXTREME HIGH</span>
                <span class="badge-status badge-secondary">UNKNOWN</span>
            </div>
        </div>

        <!-- Legend Demo -->
        <div class="test-section">
            <h3>Chart Legend Symbols</h3>
            <div class="legend-demo">
                <div class="legend-item">
                    <div class="legend-symbol legend-circle"></div>
                    <span>Inherent Risk Rating</span>
                </div>
                <div class="legend-item">
                    <div class="legend-symbol legend-diamond"></div>
                    <span>Residual Risk Rating</span>
                </div>
                <div class="legend-item">
                    <div class="legend-triangle"></div>
                    <span>Risk Appetite</span>
                </div>
            </div>
        </div>

        <!-- Chart Test -->
        <div class="test-section">
            <h3>Residual Risk Matrix Chart</h3>
            <div class="chart-container">
                <canvas id="test-residual-matrix"></canvas>
            </div>
        </div>

        <!-- Test Data Table -->
        <div class="test-section">
            <h3>Sample Data with New Badge Colors</h3>
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Kode Risiko</th>
                            <th>Unit Kerja</th>
                            <th>Inherent</th>
                            <th>Residual</th>
                            <th>Reduction</th>
                            <th>Level</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>RSK-001</strong></td>
                            <td>IT Department</td>
                            <td><span class="badge-status badge-high-risk">15</span></td>
                            <td><span class="badge-status badge-medium-risk">8</span></td>
                            <td><strong style="color: #0d4f1c; font-weight: 700;">46.7%</strong></td>
                            <td><span class="badge-status badge-medium-risk">MEDIUM RISK</span></td>
                        </tr>
                        <tr>
                            <td><strong>RSK-002</strong></td>
                            <td>Finance Department</td>
                            <td><span class="badge-status badge-extreme-high">20</span></td>
                            <td><span class="badge-status badge-high-risk">12</span></td>
                            <td><strong style="color: #0d4f1c; font-weight: 700;">40.0%</strong></td>
                            <td><span class="badge-status badge-high-risk">HIGH RISK</span></td>
                        </tr>
                        <tr>
                            <td><strong>RSK-003</strong></td>
                            <td>Operations</td>
                            <td><span class="badge-status badge-medium-risk">8</span></td>
                            <td><span class="badge-status badge-low-risk">4</span></td>
                            <td><strong style="color: #0d4f1c; font-weight: 700;">50.0%</strong></td>
                            <td><span class="badge-status badge-low-risk">LOW RISK</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Test chart with sample data
        document.addEventListener('DOMContentLoaded', function() {
            const ctx = document.getElementById('test-residual-matrix');
            
            // Sample data points
            const inherentPoints = [
                { x: 4, y: 4, riskId: 'RSK-001', value: 16, level: 'HIGH RISK', type: 'Inherent Risk' },
                { x: 5, y: 4, riskId: 'RSK-002', value: 20, level: 'EXTREME HIGH', type: 'Inherent Risk' },
                { x: 3, y: 3, riskId: 'RSK-003', value: 9, level: 'MEDIUM RISK', type: 'Inherent Risk' }
            ];
            
            const residualPoints = [
                { x: 3, y: 3, riskId: 'RSK-001', value: 9, level: 'MEDIUM RISK', type: 'Residual Risk' },
                { x: 4, y: 3, riskId: 'RSK-002', value: 12, level: 'HIGH RISK', type: 'Residual Risk' },
                { x: 2, y: 2, riskId: 'RSK-003', value: 4, level: 'LOW RISK', type: 'Residual Risk' }
            ];
            
            const appetitePoints = [
                { x: 2, y: 2, riskId: 'RSK-001', value: 4, level: 'Risk Appetite', type: 'Risk Appetite' },
                { x: 3, y: 2, riskId: 'RSK-002', value: 6, level: 'Risk Appetite', type: 'Risk Appetite' },
                { x: 1, y: 1, riskId: 'RSK-003', value: 1, level: 'Risk Appetite', type: 'Risk Appetite' }
            ];

            new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'Inherent Risk Rating',
                            data: inherentPoints,
                            backgroundColor: '#00FFFF', // Cyan
                            borderColor: '#000000',
                            borderWidth: 2,
                            pointRadius: 12,
                            pointHoverRadius: 15,
                            pointStyle: 'circle'
                        },
                        {
                            label: 'Residual Risk Rating', 
                            data: residualPoints,
                            backgroundColor: '#000000', // Black
                            borderColor: '#FFFFFF',
                            borderWidth: 2,
                            pointRadius: 12,
                            pointHoverRadius: 15,
                            pointStyle: 'rectRot' // Diamond shape
                        },
                        {
                            label: 'Risk Appetite',
                            data: appetitePoints,
                            backgroundColor: '#FFFFFF', // White
                            borderColor: '#000000',
                            borderWidth: 2,
                            pointRadius: 12,
                            pointHoverRadius: 15,
                            pointStyle: 'triangle'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'linear',
                            min: 0.5,
                            max: 5.5,
                            ticks: { 
                                stepSize: 1,
                                callback: function(value) {
                                    const labels = {
                                        1: '1 = Ringan Sekali',
                                        2: '2 = Ringan', 
                                        3: '3 = Sedang',
                                        4: '4 = Berat',
                                        5: '5 = Sangat Berat'
                                    };
                                    return labels[value] || value;
                                }
                            },
                            title: { display: true, text: 'Dampak', font: { weight: 'bold' } }
                        },
                        y: {
                            min: 0.5,
                            max: 5.5,
                            ticks: { 
                                stepSize: 1,
                                callback: function(value) {
                                    const labels = {
                                        1: '1 = Sangat Kecil (≤ 10%)',
                                        2: '2 = Kecil (10% < p ≤ 40%)',
                                        3: '3 = Sedang (40% < p ≤ 60%)',
                                        4: '4 = Besar (60% < p < 80%)',
                                        5: '5 = Sangat Besar (> 80%)'
                                    };
                                    return labels[value] || value;
                                }
                            },
                            title: { display: true, text: 'Probabilitas', font: { weight: 'bold' } }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const point = context.raw;
                                    return [
                                        `Type: ${point.type}`,
                                        `Kode: ${point.riskId}`,
                                        `Risk Value: ${point.value}`,
                                        `Level: ${point.level}`
                                    ];
                                }
                            }
                        }
                    },
                    // Add background colors for risk zones
                    onHover: function(event, activeElements) {
                        event.native.target.style.cursor = activeElements.length > 0 ? 'pointer' : 'default';
                    }
                },
                plugins: [{
                    id: 'riskZoneBackground',
                    beforeDraw: function(chart) {
                        const ctx = chart.ctx;
                        const chartArea = chart.chartArea;
                        const xScale = chart.scales.x;
                        const yScale = chart.scales.y;

                        // Define risk zone colors based on the matrix
                        const zones = [
                            // Green zones (Low Risk)
                            { x: [0.5, 1.5], y: [0.5, 2.5], color: 'rgba(76, 175, 80, 0.3)' },
                            { x: [1.5, 2.5], y: [0.5, 1.5], color: 'rgba(76, 175, 80, 0.3)' },
                            
                            // Yellow zones (Medium Risk)  
                            { x: [1.5, 2.5], y: [1.5, 2.5], color: 'rgba(255, 235, 59, 0.3)' },
                            { x: [2.5, 3.5], y: [0.5, 2.5], color: 'rgba(255, 235, 59, 0.3)' },
                            { x: [0.5, 1.5], y: [2.5, 3.5], color: 'rgba(255, 235, 59, 0.3)' },
                            
                            // Orange zones (High Risk)
                            { x: [3.5, 4.5], y: [0.5, 3.5], color: 'rgba(255, 152, 0, 0.3)' },
                            { x: [2.5, 3.5], y: [2.5, 4.5], color: 'rgba(255, 152, 0, 0.3)' },
                            { x: [1.5, 2.5], y: [2.5, 4.5], color: 'rgba(255, 152, 0, 0.3)' },
                            { x: [0.5, 1.5], y: [3.5, 5.5], color: 'rgba(255, 152, 0, 0.3)' },
                            
                            // Red zones (Extreme High Risk)
                            { x: [4.5, 5.5], y: [0.5, 5.5], color: 'rgba(244, 67, 54, 0.3)' },
                            { x: [3.5, 4.5], y: [3.5, 5.5], color: 'rgba(244, 67, 54, 0.3)' },
                            { x: [2.5, 3.5], y: [4.5, 5.5], color: 'rgba(244, 67, 54, 0.3)' }
                        ];

                        zones.forEach(zone => {
                            const x1 = xScale.getPixelForValue(zone.x[0]);
                            const x2 = xScale.getPixelForValue(zone.x[1]);
                            const y1 = yScale.getPixelForValue(zone.y[1]);
                            const y2 = yScale.getPixelForValue(zone.y[0]);

                            ctx.fillStyle = zone.color;
                            ctx.fillRect(x1, y1, x2 - x1, y2 - y1);
                        });
                    }
                }]
            });
        });
    </script>
</body>
</html>