<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rencana Strategis - Enhanced UI</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="css/rencana-strategis-enhanced.css" rel="stylesheet">
    
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .container-fluid {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Additional custom styles */
        .page-content {
            min-height: 100vh;
            padding: 2rem 0;
        }
        
        .page-content.active {
            display: block;
        }
        
        .shadow-sm {
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075) !important;
        }
    </style>
    <link rel="stylesheet" href="css/remove-purple-colors.css">
</head>
<body>
    <div class="page-content active" id="rencana-strategis">
        <div id="rencana-strategis-content" class="container-fluid p-4">
            <!-- Content will be loaded here by JavaScript -->
            <div class="text-center py-5">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-3 text-muted">Memuat halaman Rencana Strategis...</p>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- XLSX Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- Mock API for testing -->
    <script>
        // Mock API function
        window.apiCall = async (endpoint, options = {}) => {
            console.log('Mock API call:', endpoint, options);
            
            // Simulate network delay
            await new Promise(resolve => setTimeout(resolve, 500));
            
            if (endpoint.includes('/api/rencana-strategis/public') || endpoint.includes('/api/rencana-strategis')) {
                if (options.method === 'POST') {
                    return { message: 'Rencana strategis berhasil dibuat', data: { id: Date.now(), ...options.body } };
                } else if (options.method === 'PUT') {
                    return { message: 'Rencana strategis berhasil diupdate', data: { id: endpoint.split('/').pop(), ...options.body } };
                } else if (options.method === 'DELETE') {
                    return { message: 'Rencana strategis berhasil dihapus' };
                } else {
                    // GET request - return mock data
                    return [
                        {
                            id: '1',
                            kode: 'RS-2025-001',
                            nama_rencana: 'Peningkatan Kualitas Pelayanan',
                            deskripsi: 'Meningkatkan kualitas pelayanan kepada masyarakat melalui digitalisasi dan pelatihan SDM',
                            periode_mulai: '2025-01-01',
                            periode_selesai: '2025-12-31',
                            target: 'Mencapai tingkat kepuasan masyarakat 90%',
                            indikator_kinerja: 'Indeks Kepuasan Masyarakat',
                            status: 'Aktif',
                            visi_misi_id: '1',
                            sasaran_strategis: ['Digitalisasi layanan', 'Pelatihan SDM', 'Monitoring berkala'],
                            indikator_kinerja_utama: ['IKM > 90%', 'Waktu pelayanan < 30 menit', 'Zero complaint']
                        },
                        {
                            id: '2',
                            kode: 'RS-2025-002',
                            nama_rencana: 'Pengembangan Infrastruktur TI',
                            deskripsi: 'Membangun infrastruktur teknologi informasi yang handal dan terintegrasi',
                            periode_mulai: '2025-02-01',
                            periode_selesai: '2025-11-30',
                            target: 'Implementasi sistem terintegrasi 100%',
                            indikator_kinerja: 'Persentase sistem terintegrasi',
                            status: 'Draft',
                            visi_misi_id: '1',
                            sasaran_strategis: ['Upgrade hardware', 'Implementasi software', 'Training user'],
                            indikator_kinerja_utama: ['Uptime 99.9%', 'Response time < 2 detik', 'User adoption 95%']
                        },
                        {
                            id: '3',
                            kode: 'RS-2025-003',
                            nama_rencana: 'Program Inovasi Berkelanjutan',
                            deskripsi: 'Mengembangkan budaya inovasi untuk peningkatan efisiensi dan efektivitas organisasi',
                            periode_mulai: '2025-03-01',
                            periode_selesai: '2025-12-31',
                            target: 'Minimal 10 inovasi per tahun',
                            indikator_kinerja: 'Jumlah inovasi yang diimplementasikan',
                            status: 'Selesai',
                            visi_misi_id: '2',
                            sasaran_strategis: ['Workshop inovasi', 'Kompetisi ide', 'Implementasi pilot project'],
                            indikator_kinerja_utama: ['10 inovasi/tahun', 'ROI > 15%', 'Adoption rate 80%']
                        }
                    ];
                }
            } else if (endpoint.includes('/api/visi-misi')) {
                return [
                    {
                        id: '1',
                        visi: 'Menjadi organisasi terdepan dalam pelayanan publik',
                        misi: '1. Memberikan pelayanan prima kepada masyarakat\n2. Mengembangkan SDM yang kompeten\n3. Memanfaatkan teknologi untuk efisiensi',
                        tahun: 2025,
                        organization_id: '1'
                    },
                    {
                        id: '2',
                        visi: 'Organisasi inovatif dan berkelanjutan',
                        misi: '1. Mengembangkan inovasi berkelanjutan\n2. Membangun kemitraan strategis\n3. Menjaga kelestarian lingkungan',
                        tahun: 2025,
                        organization_id: '1'
                    }
                ];
            } else if (endpoint.includes('/generate/kode')) {
                const year = new Date().getFullYear();
                const random = String(Math.floor(Math.random() * 1000)).padStart(3, '0');
                return { kode: `RS-${year}-${random}` };
            }
            
            return [];
        };
        
        // Mock auth ready function
        window.waitForAuthReady = async (timeout = 5000) => {
            return new Promise(resolve => setTimeout(resolve, 100));
        };
    </script>
    
    <!-- Load the enhanced module -->
    <script src="js/rencana-strategis-enhanced.js"></script>
    
    <script>
        // Initialize the module when page loads
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ Initializing Rencana Strategis Enhanced...');
            
            try {
                await RencanaStrategisModuleEnhanced.load();
                console.log('‚úÖ Rencana Strategis Enhanced initialized successfully');
            } catch (error) {
                console.error('‚ùå Failed to initialize:', error);
            }
        });
    </script>
    <script src="js/remove-purple-colors.js"></script>
</body>
</html>