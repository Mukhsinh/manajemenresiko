<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Rencana Strategis UI Fix</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/rencana-strategis.css">
    <link rel="stylesheet" href="/css/rencana-strategis-blue-header.css">
    <style>
        body { background: #f5f7fa; padding: 20px; }
        .test-section { background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .test-result { padding: 10px; border-radius: 8px; margin: 5px 0; }
        .test-pass { background: #d4edda; color: #155724; }
        .test-fail { background: #f8d7da; color: #721c24; }
        .test-pending { background: #fff3cd; color: #856404; }
        #test-log { max-height: 300px; overflow-y: auto; font-family: monospace; font-size: 12px; background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; }
    </style>
</head>
<body>
    <div class="container-fluid">
        <h1 class="mb-4"><i class="fas fa-vial text-primary me-2"></i>Test Rencana Strategis UI Fix</h1>
        
        <!-- Test Controls -->
        <div class="test-section">
            <h5><i class="fas fa-play-circle me-2"></i>Test Controls</h5>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="runAllTests()"><i class="fas fa-play me-1"></i>Run All Tests</button>
                <button class="btn btn-outline-secondary" onclick="clearResults()"><i class="fas fa-eraser me-1"></i>Clear Results</button>
            </div>
        </div>

        <!-- Test Results -->
        <div class="test-section">
            <h5><i class="fas fa-clipboard-check me-2"></i>Test Results</h5>
            <div id="test-results"></div>
        </div>

        <!-- Test Log -->
        <div class="test-section">
            <h5><i class="fas fa-terminal me-2"></i>Test Log</h5>
            <div id="test-log"></div>
        </div>

        <!-- Demo Section -->
        <div class="test-section">
            <h5><i class="fas fa-desktop me-2"></i>Live Demo</h5>
            <div id="rencana-strategis" class="page-content active">
                <div id="rencana-strategis-content">
                    <div class="rencana-strategis-wrapper p-3">
                        <!-- Stats Cards -->
                        <div class="row g-3 mb-4">
                            <div class="col-xl-3 col-md-6">
                                <div class="card h-100 border-0 shadow-sm">
                                    <div class="card-body p-0">
                                        <div class="d-flex align-items-center">
                                            <div class="flex-shrink-0 d-flex align-items-center justify-content-center" style="width: 80px; height: 100px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">
                                                <i class="fas fa-check-circle fa-2x text-white"></i>
                                            </div>
                                            <div class="flex-grow-1 p-3">
                                                <h3 class="fw-bold text-success mb-0">3</h3>
                                                <p class="text-muted mb-0 small">Rencana Aktif</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div class="card h-100 border-0 shadow-sm">
                                    <div class="card-body p-0">
                                        <div class="d-flex align-items-center">
                                            <div class="flex-shrink-0 d-flex align-items-center justify-content-center" style="width: 80px; height: 100px; background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);">
                                                <i class="fas fa-edit fa-2x text-white"></i>
                                            </div>
                                            <div class="flex-grow-1 p-3">
                                                <h3 class="fw-bold text-warning mb-0">2</h3>
                                                <p class="text-muted mb-0 small">Draft</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div class="card h-100 border-0 shadow-sm">
                                    <div class="card-body p-0">
                                        <div class="d-flex align-items-center">
                                            <div class="flex-shrink-0 d-flex align-items-center justify-content-center" style="width: 80px; height: 100px; background: linear-gradient(135deg, #007bff 0%, #6f42c1 100%);">
                                                <i class="fas fa-flag-checkered fa-2x text-white"></i>
                                            </div>
                                            <div class="flex-grow-1 p-3">
                                                <h3 class="fw-bold text-primary mb-0">1</h3>
                                                <p class="text-muted mb-0 small">Selesai</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div class="card h-100 border-0 shadow-sm">
                                    <div class="card-body p-0">
                                        <div class="d-flex align-items-center">
                                            <div class="flex-shrink-0 d-flex align-items-center justify-content-center" style="width: 80px; height: 100px; background: linear-gradient(135deg, #6c757d 0%, #495057 100%);">
                                                <i class="fas fa-list-alt fa-2x text-white"></i>
                                            </div>
                                            <div class="flex-grow-1 p-3">
                                                <h3 class="fw-bold text-secondary mb-0">6</h3>
                                                <p class="text-muted mb-0 small">Total</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Table Card -->
                        <div class="card shadow-sm border-0">
                            <div class="card-header bg-white d-flex justify-content-between align-items-center py-3">
                                <div>
                                    <h5 class="mb-0"><i class="fas fa-table text-primary me-2"></i>Daftar Rencana Strategis</h5>
                                    <small class="text-muted">Kelola semua rencana strategis</small>
                                </div>
                                <div class="btn-group">
                                    <button class="btn btn-outline-primary" id="rs-refresh-btn"><i class="fas fa-sync-alt me-1"></i>Refresh</button>
                                    <button class="btn btn-outline-success" id="rs-export-btn"><i class="fas fa-file-excel me-1"></i>Export</button>
                                </div>
                            </div>
                            <div class="card-body p-0">
                                <div class="table-responsive">
                                    <table class="table table-hover mb-0">
                                        <thead>
                                            <tr>
                                                <th><i class="fas fa-barcode me-1"></i>Kode</th>
                                                <th><i class="fas fa-file-alt me-1"></i>Nama Rencana</th>
                                                <th><i class="fas fa-crosshairs me-1"></i>Target</th>
                                                <th><i class="fas fa-calendar me-1"></i>Periode</th>
                                                <th><i class="fas fa-flag me-1"></i>Status</th>
                                                <th class="text-center"><i class="fas fa-cogs me-1"></i>Aksi</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr data-id="1">
                                                <td><span class="badge bg-light text-dark border">RS-2026-001</span></td>
                                                <td><div class="fw-semibold">Peningkatan Kualitas Layanan</div><small class="text-muted">Meningkatkan kualitas layanan kesehatan</small></td>
                                                <td><small class="text-muted">90% kepuasan pasien</small></td>
                                                <td><small><i class="fas fa-calendar-alt me-1"></i>Jan 2026 - Des 2026</small></td>
                                                <td><span class="badge bg-success">Aktif</span></td>
                                                <td class="text-center">
                                                    <div class="btn-group btn-group-sm">
                                                        <button class="btn btn-outline-info border-0" title="Lihat"><i class="fas fa-eye"></i></button>
                                                        <button class="btn btn-outline-warning border-0" title="Edit"><i class="fas fa-edit"></i></button>
                                                        <button class="btn btn-outline-danger border-0" title="Hapus"><i class="fas fa-trash"></i></button>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr data-id="2" style="background:#fafbfc">
                                                <td><span class="badge bg-light text-dark border">RS-2026-002</span></td>
                                                <td><div class="fw-semibold">Pengembangan SDM</div><small class="text-muted">Program pelatihan dan pengembangan</small></td>
                                                <td><small class="text-muted">100 jam pelatihan/tahun</small></td>
                                                <td><small><i class="fas fa-calendar-alt me-1"></i>Feb 2026 - Nov 2026</small></td>
                                                <td><span class="badge bg-warning text-dark">Draft</span></td>
                                                <td class="text-center">
                                                    <div class="btn-group btn-group-sm">
                                                        <button class="btn btn-outline-info border-0" title="Lihat"><i class="fas fa-eye"></i></button>
                                                        <button class="btn btn-outline-warning border-0" title="Edit"><i class="fas fa-edit"></i></button>
                                                        <button class="btn btn-outline-danger border-0" title="Hapus"><i class="fas fa-trash"></i></button>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/rencana-strategis-ui-fix.js"></script>
    <script>
        const testResults = [];
        const logEl = document.getElementById('test-log');
        const resultsEl = document.getElementById('test-results');

        function log(message) {
            const time = new Date().toLocaleTimeString();
            logEl.innerHTML += `[${time}] ${message}\n`;
            logEl.scrollTop = logEl.scrollHeight;
            console.log(message);
        }

        function addResult(name, passed, details = '') {
            testResults.push({ name, passed, details });
            const statusClass = passed ? 'test-pass' : 'test-fail';
            const icon = passed ? 'check-circle' : 'times-circle';
            resultsEl.innerHTML += `
                <div class="test-result ${statusClass}">
                    <i class="fas fa-${icon} me-2"></i>
                    <strong>${name}</strong>
                    ${details ? `<br><small>${details}</small>` : ''}
                </div>
            `;
        }

        function clearResults() {
            testResults.length = 0;
            resultsEl.innerHTML = '';
            logEl.innerHTML = '';
        }

        async function runAllTests() {
            clearResults();
            log('ðŸš€ Starting all tests...');

            // Test 1: Blue Header Color
            await testBlueHeader();

            // Test 2: Filter Section Exists
            await testFilterSection();

            // Test 3: Buttons Exist
            await testButtonsExist();

            // Test 4: Event Delegation
            await testEventDelegation();

            // Test 5: Data-ID on Rows
            await testDataIdOnRows();

            // Summary
            const passed = testResults.filter(t => t.passed).length;
            const total = testResults.length;
            log(`\nâœ… Tests completed: ${passed}/${total} passed`);
        }

        async function testBlueHeader() {
            log('Testing blue header color...');
            const th = document.querySelector('.rencana-strategis-wrapper .table thead th');
            if (!th) {
                addResult('Blue Header Color', false, 'Table header not found');
                return;
            }

            const style = window.getComputedStyle(th);
            const bgColor = style.backgroundColor;
            
            // Check if it's blue (rgb(0, 123, 255) = #007bff)
            const isBlue = bgColor.includes('0, 123, 255') || bgColor.includes('0,123,255');
            const hasNoGradient = !style.backgroundImage || style.backgroundImage === 'none';
            const isWhiteText = style.color.includes('255, 255, 255') || style.color.includes('255,255,255');

            const passed = isBlue && hasNoGradient && isWhiteText;
            addResult('Blue Header Color', passed, 
                `BG: ${bgColor}, Gradient: ${style.backgroundImage}, Text: ${style.color}`);
            log(`  Header color: ${passed ? 'âœ… PASS' : 'âŒ FAIL'}`);
        }

        async function testFilterSection() {
            log('Testing filter section...');
            
            // Wait for UI fix to initialize
            await new Promise(r => setTimeout(r, 500));
            
            const filterSection = document.getElementById('rs-filter-section');
            const yearFilter = document.getElementById('rs-filter-year');
            const statusFilter = document.getElementById('rs-filter-status');
            const searchFilter = document.getElementById('rs-filter-search');
            const resetBtn = document.getElementById('rs-filter-reset');
            const addBtn = document.getElementById('rs-add-btn');

            const passed = filterSection && yearFilter && statusFilter && searchFilter && resetBtn && addBtn;
            addResult('Filter Section', passed, 
                `Section: ${!!filterSection}, Year: ${!!yearFilter}, Status: ${!!statusFilter}, Search: ${!!searchFilter}, Reset: ${!!resetBtn}, Add: ${!!addBtn}`);
            log(`  Filter section: ${passed ? 'âœ… PASS' : 'âŒ FAIL'}`);
        }

        async function testButtonsExist() {
            log('Testing buttons exist...');
            
            const refreshBtn = document.getElementById('rs-refresh-btn');
            const exportBtn = document.getElementById('rs-export-btn');
            const viewBtns = document.querySelectorAll('.btn-outline-info');
            const editBtns = document.querySelectorAll('.btn-outline-warning');
            const deleteBtns = document.querySelectorAll('.btn-outline-danger');

            const passed = refreshBtn && exportBtn && viewBtns.length > 0 && editBtns.length > 0 && deleteBtns.length > 0;
            addResult('Buttons Exist', passed, 
                `Refresh: ${!!refreshBtn}, Export: ${!!exportBtn}, View: ${viewBtns.length}, Edit: ${editBtns.length}, Delete: ${deleteBtns.length}`);
            log(`  Buttons: ${passed ? 'âœ… PASS' : 'âŒ FAIL'}`);
        }

        async function testEventDelegation() {
            log('Testing event delegation...');
            
            // Check if RencanaStrategisUIFix is loaded
            const uiFixLoaded = typeof window.RencanaStrategisUIFix !== 'undefined';
            const hasHandlers = uiFixLoaded && 
                typeof window.RencanaStrategisUIFix.handleAddClick === 'function' &&
                typeof window.RencanaStrategisUIFix.handleEditClick === 'function' &&
                typeof window.RencanaStrategisUIFix.handleDeleteClick === 'function';

            addResult('Event Delegation', hasHandlers, 
                `UI Fix loaded: ${uiFixLoaded}, Handlers: ${hasHandlers}`);
            log(`  Event delegation: ${hasHandlers ? 'âœ… PASS' : 'âŒ FAIL'}`);
        }

        async function testDataIdOnRows() {
            log('Testing data-id on rows...');
            
            const rows = document.querySelectorAll('.rencana-strategis-wrapper table tbody tr[data-id]');
            const passed = rows.length > 0;
            
            addResult('Data-ID on Rows', passed, `Rows with data-id: ${rows.length}`);
            log(`  Data-ID: ${passed ? 'âœ… PASS' : 'âŒ FAIL'}`);
        }

        // Auto-run tests on load
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 1000);
        });
    </script>
</body>
</html>
