<!DOCTYPE html>\n<html lang=\"id\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Final URL Routing Test - Risk Management System</title>\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n    <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css\" rel=\"stylesheet\">\n    <style>\n        body {\n            background: #ffffff;\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            min-height: 100vh;\n        }\n        \n        .test-container {\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 2rem;\n        }\n        \n        .test-header {\n            background: rgba(255, 255, 255, 0.95);\n            color: #333;\n            padding: 2rem;\n            border-radius: 15px;\n            margin-bottom: 2rem;\n            text-align: center;\n            box-shadow: 0 10px 30px rgba(0,0,0,0.2);\n        }\n        \n        .url-display {\n            background: #2c3e50;\n            color: #ecf0f1;\n            padding: 1rem;\n            border-radius: 8px;\n            font-family: 'Courier New', monospace;\n            font-size: 1.1rem;\n            margin: 1rem 0;\n            word-break: break-all;\n            border: 2px solid #34495e;\n        }\n        \n        .test-section {\n            background: rgba(255, 255, 255, 0.95);\n            border-radius: 15px;\n            padding: 2rem;\n            margin-bottom: 2rem;\n            box-shadow: 0 10px 30px rgba(0,0,0,0.1);\n        }\n        \n        .nav-button {\n            margin: 0.5rem;\n            min-width: 250px;\n            padding: 12px 20px;\n            border-radius: 8px;\n            font-weight: 500;\n            transition: all 0.3s ease;\n            border: none;\n        }\n        \n        .nav-button:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 5px 15px rgba(0,0,0,0.2);\n        }\n        \n        .test-result {\n            padding: 1rem;\n            border-radius: 8px;\n            margin: 0.5rem 0;\n            font-family: 'Courier New', monospace;\n            font-size: 0.9rem;\n        }\n        \n        .success {\n            background-color: #d4edda;\n            color: #155724;\n            border: 1px solid #c3e6cb;\n        }\n        \n        .error {\n            background-color: #f8d7da;\n            color: #721c24;\n            border: 1px solid #f5c6cb;\n        }\n        \n        .info {\n            background-color: #d1ecf1;\n            color: #0c5460;\n            border: 1px solid #bee5eb;\n        }\n        \n        .warning {\n            background-color: #fff3cd;\n            color: #856404;\n            border: 1px solid #ffeaa7;\n        }\n        \n        .navigation-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n            gap: 1rem;\n            margin: 1.5rem 0;\n        }\n        \n        .status-indicator {\n            display: inline-block;\n            width: 12px;\n            height: 12px;\n            border-radius: 50%;\n            margin-right: 8px;\n        }\n        \n        .status-success { background-color: #28a745; }\n        .status-error { background-color: #dc3545; }\n        .status-warning { background-color: #ffc107; }\n        .status-info { background-color: #17a2b8; }\n        \n        .stats-card {\n            background: linear-gradient(135deg, #3498db, #2980b9);\n            color: white;\n            padding: 1.5rem;\n            border-radius: 10px;\n            text-align: center;\n            margin: 0.5rem;\n        }\n        \n        .stats-number {\n            font-size: 2rem;\n            font-weight: bold;\n            display: block;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"test-container\">\n        <div class=\"test-header\">\n            <h1><i class=\"fas fa-route\"></i> Final URL Routing Test</h1>\n            <p>Comprehensive test to verify URL routing system is working correctly</p>\n            <div class=\"url-display\" id=\"current-url\">\n                <i class=\"fas fa-link\"></i> Current URL: Loading...\n            </div>\n        </div>\n        \n        <!-- Router Status -->        \n        <div class=\"test-section\">\n            <h3><i class=\"fas fa-cogs\"></i> Router System Status</h3>\n            <div class=\"row\" id=\"router-status-cards\"></div>\n            <div id=\"router-status-details\"></div>\n            <button class=\"btn btn-primary\" onclick=\"checkRouterStatus()\">\n                <i class=\"fas fa-sync\"></i> Refresh Status\n            </button>\n        </div>\n        \n        <!-- Navigation Test -->        \n        <div class=\"test-section\">\n            <h3><i class=\"fas fa-compass\"></i> Navigation Test</h3>\n            <p>Click buttons below to test navigation. URL should change and page should load correctly:</p>\n            \n            <div class=\"navigation-grid\">\n                <!-- Strategic Planning -->\n                <button class=\"btn btn-success nav-button\" onclick=\"testNavigation('/dashboard', 'Dashboard')\">\n                    <i class=\"fas fa-tachometer-alt\"></i> Dashboard\n                </button>\n                \n                <button class=\"btn btn-info nav-button\" onclick=\"testNavigation('/visi-misi', 'Visi & Misi')\">\n                    <i class=\"fas fa-eye\"></i> Visi & Misi\n                </button>\n                \n                <button class=\"btn btn-info nav-button\" onclick=\"testNavigation('/rencana-strategis', 'Rencana Strategis')\">\n                    <i class=\"fas fa-chess\"></i> Rencana Strategis\n                </button>\n                \n                <button class=\"btn btn-info nav-button\" onclick=\"testNavigation('/analisis-swot', 'Analisis SWOT')\">\n                    <i class=\"fas fa-chart-line\"></i> Analisis SWOT\n                </button>\n                \n                <button class=\"btn btn-info nav-button\" onclick=\"testNavigation('/sasaran-strategi', 'Sasaran Strategi')\">\n                    <i class=\"fas fa-bullseye\"></i> Sasaran Strategi\n                </button>\n                \n                <button class=\"btn btn-info nav-button\" onclick=\"testNavigation('/strategic-map', 'Strategic Map')\">\n                    <i class=\"fas fa-map\"></i> Strategic Map\n                </button>\n                \n                <!-- Risk Management -->\n                <button class=\"btn btn-warning nav-button\" onclick=\"testNavigation('/manajemen-risiko/input-data', 'Risk Input')\">\n                    <i class=\"fas fa-shield-alt\"></i> Risk Input\n                </button>\n                \n                <button class=\"btn btn-warning nav-button\" onclick=\"testNavigation('/manajemen-risiko/risk-profile', 'Risk Profile')\">\n                    <i class=\"fas fa-user-shield\"></i> Risk Profile\n                </button>\n                \n                <button class=\"btn btn-warning nav-button\" onclick=\"testNavigation('/manajemen-risiko/residual-risk', 'Residual Risk')\">\n                    <i class=\"fas fa-exclamation-triangle\"></i> Residual Risk\n                </button>\n                \n                <button class=\"btn btn-warning nav-button\" onclick=\"testNavigation('/manajemen-risiko/kri', 'Key Risk Indicator')\">\n                    <i class=\"fas fa-key\"></i> KRI\n                </button>\n                \n                <!-- Reports & Data -->\n                <button class=\"btn btn-secondary nav-button\" onclick=\"testNavigation('/laporan', 'Laporan')\">\n                    <i class=\"fas fa-file-alt\"></i> Laporan\n                </button>\n                \n                <button class=\"btn btn-secondary nav-button\" onclick=\"testNavigation('/master-data', 'Master Data')\">\n                    <i class=\"fas fa-database\"></i> Master Data\n                </button>\n                \n                <!-- Test 404 -->\n                <button class=\"btn btn-danger nav-button\" onclick=\"testNavigation('/invalid-page-test', '404 Test')\">\n                    <i class=\"fas fa-exclamation-triangle\"></i> 404 Test\n                </button>\n            </div>\n            \n            <div id=\"navigation-results\"></div>\n        </div>\n        \n        <!-- Browser History Test -->        \n        <div class=\"test-section\">\n            <h3><i class=\"fas fa-history\"></i> Browser History Test</h3>\n            <p>Test browser back/forward functionality:</p>\n            \n            <button class=\"btn btn-outline-primary\" onclick=\"goBack()\">\n                <i class=\"fas fa-arrow-left\"></i> Go Back\n            </button>\n            \n            <button class=\"btn btn-outline-primary\" onclick=\"goForward()\">\n                <i class=\"fas fa-arrow-right\"></i> Go Forward\n            </button>\n            \n            <button class=\"btn btn-outline-info\" onclick=\"refreshPage()\">\n                <i class=\"fas fa-sync\"></i> Refresh Page\n            </button>\n            \n            <div id=\"history-results\"></div>\n        </div>\n        \n        <!-- Test Statistics -->        \n        <div class=\"test-section\">\n            <h3><i class=\"fas fa-chart-bar\"></i> Test Statistics</h3>\n            <div class=\"row\" id=\"test-stats\"></div>\n        </div>\n        \n        <!-- Test Log -->        \n        <div class=\"test-section\">\n            <h3><i class=\"fas fa-list\"></i> Test Log</h3>\n            <div id=\"test-log\"></div>\n            <button class=\"btn btn-outline-secondary\" onclick=\"clearLog()\">\n                <i class=\"fas fa-trash\"></i> Clear Log\n            </button>\n        </div>\n    </div>\n    \n    <!-- Load Router Scripts -->\n    <script src=\"/js/router.js\"></script>\n    <script src=\"/js/route-config.js\"></script>\n    <script src=\"/js/404-handler.js\"></script>\n    <script src=\"/js/router-integration.js\"></script>\n    \n    <script>\n        let testLog = [];\n        let router = null;\n        let authGuard = null;\n        let testStats = {\n            totalTests: 0,\n            passedTests: 0,\n            failedTests: 0,\n            routerReady: false\n        };\n        \n        // Initialize test environment\n        document.addEventListener('DOMContentLoaded', function() {\n            console.log('ðŸ§ª Final URL Routing Test initialized');\n            updateCurrentUrl();\n            initializeTestRouter();\n            checkRouterStatus();\n            updateTestStats();\n            \n            // Listen for URL changes\n            window.addEventListener('popstate', function() {\n                updateCurrentUrl();\n                logTest('Browser navigation detected', 'info');\n            });\n        });\n        \n        // Update current URL display\n        function updateCurrentUrl() {\n            const currentUrl = window.location.href;\n            document.getElementById('current-url').innerHTML = `<i class=\"fas fa-link\"></i> Current URL: ${currentUrl}`;\n        }\n        \n        // Initialize test router\n        function initializeTestRouter() {\n            try {\n                // Check dependencies\n                if (typeof SPARouter === 'undefined' || typeof AuthGuard === 'undefined' || typeof ROUTE_CONFIG === 'undefined') {\n                    logTest('Router dependencies not available, retrying in 500ms...', 'warning');\n                    setTimeout(initializeTestRouter, 500);\n                    return;\n                }\n                \n                // Create auth guard (allow all for testing)\n                authGuard = new AuthGuard({\n                    isAuthenticated: () => true // Allow all routes for testing\n                });\n                \n                // Create router instance\n                router = new SPARouter(ROUTE_CONFIG, {\n                    authGuard: authGuard,\n                    fallbackRoute: '/404'\n                });\n                \n                // Make globally available\n                window.appRouter = router;\n                window.authGuard = authGuard;\n                \n                testStats.routerReady = true;\n                logTest('Router initialized successfully', 'success');\n                updateTestStats();\n                \n            } catch (error) {\n                logTest(`Router initialization failed: ${error.message}`, 'error');\n                setTimeout(initializeTestRouter, 1000);\n            }\n        }\n        \n        // Check router status\n        function checkRouterStatus() {\n            const statusDiv = document.getElementById('router-status-details');\n            const cardsDiv = document.getElementById('router-status-cards');\n            \n            let status = [];\n            \n            // Check router components\n            const checks = [\n                { name: 'SPARouter Class', test: typeof SPARouter === 'function', icon: 'fas fa-route' },\n                { name: 'AuthGuard Class', test: typeof AuthGuard === 'function', icon: 'fas fa-shield-alt' },\n                { name: 'Route Configuration', test: typeof ROUTE_CONFIG === 'object' && Object.keys(ROUTE_CONFIG).length > 0, icon: 'fas fa-map' },\n                { name: 'Router Instance', test: !!router, icon: 'fas fa-cogs' },\n                { name: 'URL Mapping Functions', test: typeof getUrlForPage === 'function', icon: 'fas fa-link' }\n            ];\n            \n            // Create status cards\n            let cardsHtml = '';\n            checks.forEach(check => {\n                const statusClass = check.test ? 'success' : 'error';\n                const statusIcon = check.test ? 'fas fa-check' : 'fas fa-times';\n                \n                cardsHtml += `\n                    <div class=\"col-md-4 col-sm-6\">\n                        <div class=\"stats-card ${statusClass === 'success' ? 'bg-success' : 'bg-danger'}\">\n                            <i class=\"${check.icon}\"></i>\n                            <span class=\"stats-number\">\n                                <i class=\"${statusIcon}\"></i>\n                            </span>\n                            <small>${check.name}</small>\n                        </div>\n                    </div>\n                `;\n                \n                status.push({\n                    test: check.name,\n                    result: check.test ? 'Available' : 'Missing',\n                    status: statusClass\n                });\n            });\n            \n            cardsDiv.innerHTML = cardsHtml;\n            \n            // Detailed status\n            let detailsHtml = '<h5>Detailed Status:</h5>';\n            status.forEach(result => {\n                detailsHtml += `<div class=\"test-result ${result.status}\"><strong>${result.test}:</strong> ${result.result}</div>`;\n            });\n            \n            if (router && ROUTE_CONFIG) {\n                detailsHtml += `<div class=\"test-result info\"><strong>Total Routes:</strong> ${Object.keys(ROUTE_CONFIG).length}</div>`;\n            }\n            \n            statusDiv.innerHTML = detailsHtml;\n        }\n        \n        // Test navigation\n        function testNavigation(url, pageName) {\n            testStats.totalTests++;\n            logTest(`Testing navigation to ${url} (${pageName})`, 'info');\n            \n            const beforeUrl = window.location.href;\n            \n            try {\n                if (router) {\n                    router.navigate(url);\n                    \n                    setTimeout(() => {\n                        const afterUrl = window.location.href;\n                        const urlChanged = beforeUrl !== afterUrl;\n                        \n                        const result = {\n                            test: `Navigation to ${url}`,\n                            result: urlChanged ? `URL changed: ${afterUrl}` : 'URL did not change',\n                            status: urlChanged ? 'success' : 'error'\n                        };\n                        \n                        const resultsDiv = document.getElementById('navigation-results');\n                        displayResults(resultsDiv, [result], true);\n                        \n                        updateCurrentUrl();\n                        \n                        if (urlChanged) {\n                            testStats.passedTests++;\n                            logTest(`âœ… Navigation to ${url} successful`, 'success');\n                        } else {\n                            testStats.failedTests++;\n                            logTest(`âŒ Navigation to ${url} failed - URL did not change`, 'error');\n                        }\n                        \n                        updateTestStats();\n                        \n                    }, 100);\n                } else {\n                    testStats.failedTests++;\n                    logTest('âŒ Router not available', 'error');\n                    updateTestStats();\n                }\n                \n            } catch (error) {\n                testStats.failedTests++;\n                logTest(`âŒ Navigation error: ${error.message}`, 'error');\n                updateTestStats();\n            }\n        }\n        \n        // Browser history functions\n        function goBack() {\n            logTest('Testing browser back button', 'info');\n            window.history.back();\n            setTimeout(() => {\n                updateCurrentUrl();\n                logTest('Browser back completed', 'success');\n            }, 100);\n        }\n        \n        function goForward() {\n            logTest('Testing browser forward button', 'info');\n            window.history.forward();\n            setTimeout(() => {\n                updateCurrentUrl();\n                logTest('Browser forward completed', 'success');\n            }, 100);\n        }\n        \n        function refreshPage() {\n            logTest('Testing page refresh', 'info');\n            window.location.reload();\n        }\n        \n        // Update test statistics\n        function updateTestStats() {\n            const statsDiv = document.getElementById('test-stats');\n            \n            const successRate = testStats.totalTests > 0 ? Math.round((testStats.passedTests / testStats.totalTests) * 100) : 0;\n            \n            statsDiv.innerHTML = `\n                <div class=\"col-md-3\">\n                    <div class=\"stats-card bg-primary\">\n                        <i class=\"fas fa-vial\"></i>\n                        <span class=\"stats-number\">${testStats.totalTests}</span>\n                        <small>Total Tests</small>\n                    </div>\n                </div>\n                <div class=\"col-md-3\">\n                    <div class=\"stats-card bg-success\">\n                        <i class=\"fas fa-check\"></i>\n                        <span class=\"stats-number\">${testStats.passedTests}</span>\n                        <small>Passed</small>\n                    </div>\n                </div>\n                <div class=\"col-md-3\">\n                    <div class=\"stats-card bg-danger\">\n                        <i class=\"fas fa-times\"></i>\n                        <span class=\"stats-number\">${testStats.failedTests}</span>\n                        <small>Failed</small>\n                    </div>\n                </div>\n                <div class=\"col-md-3\">\n                    <div class=\"stats-card ${successRate >= 80 ? 'bg-success' : successRate >= 60 ? 'bg-warning' : 'bg-danger'}\">\n                        <i class=\"fas fa-percentage\"></i>\n                        <span class=\"stats-number\">${successRate}%</span>\n                        <small>Success Rate</small>\n                    </div>\n                </div>\n            `;\n        }\n        \n        // Utility functions\n        function displayResults(container, results, append = false) {\n            if (!append) {\n                container.innerHTML = '';\n            }\n            \n            results.forEach(result => {\n                const div = document.createElement('div');\n                div.className = `test-result ${result.status}`;\n                div.innerHTML = `<span class=\"status-indicator status-${result.status}\"></span><strong>${result.test}:</strong> ${result.result}`;\n                container.appendChild(div);\n            });\n        }\n        \n        function logTest(message, type = 'info') {\n            const timestamp = new Date().toLocaleTimeString();\n            testLog.push({ timestamp, message, type });\n            \n            const logDiv = document.getElementById('test-log');\n            const logEntry = document.createElement('div');\n            logEntry.className = `test-result ${type}`;\n            logEntry.innerHTML = `<span class=\"status-indicator status-${type}\"></span><strong>[${timestamp}]</strong> ${message}`;\n            logDiv.appendChild(logEntry);\n            \n            // Keep only last 50 entries\n            while (logDiv.children.length > 50) {\n                logDiv.removeChild(logDiv.firstChild);\n            }\n            \n            // Scroll to bottom\n            logDiv.scrollTop = logDiv.scrollHeight;\n        }\n        \n        function clearLog() {\n            testLog = [];\n            document.getElementById('test-log').innerHTML = '';\n            testStats = {\n                totalTests: 0,\n                passedTests: 0,\n                failedTests: 0,\n                routerReady: testStats.routerReady\n            };\n            updateTestStats();\n        }\n    </script>\n</body>\n</html>"